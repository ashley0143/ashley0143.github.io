<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Breach Clock</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" href="https://www.twentyonepilots.com/sites/g/files/g2000018171/files/Favicon_6.png" type="image/png" />
  <link href="https://site-assets.fontawesome.com/releases/v6.1.1/css/all.css" rel="stylesheet" />
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Martian+Mono&display=swap');
  </style>

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    html, body {
      height: 100%; width: 100%;
      font-family: 'Martian Mono', monospace;
      color: #fff;
      display: flex; align-items: center; justify-content: center;
      text-shadow: 0 0 10px rgba(0,0,0,0.7);
      /* Layered backgrounds (from back to front) */
      background-image:
        url('https://nitter.net/pic/media%2FGz7rRzDXEAATCsx.jpg%3Fname%3Dsmall%26format%3Dwebp'),
        url('https://www.twentyonepilots.com/sites/g/files/g2000020241/files/2025-06/desktopHeaderBg_0.jpg'),
        url('https://www.twentyonepilots.com/sites/g/files/g2000020241/files/2025-06/tourBG.jpg');
      background-size: cover, cover, cover;
      background-position: center, center, center;
      background-repeat: no-repeat, no-repeat, no-repeat;
      background-attachment: fixed, fixed, fixed;
      background-blend-mode: normal, overlay, normal;
    }

    /* Theme flip keeps BOTH desktopHeaderBg_0.jpg and tourBG.jpg, plus the Nitter image */
    body.red {
      background-image:
        url('https://www.twentyonepilots.com/sites/g/files/g2000020241/files/2025-06/tourBG.jpg'),
        url('https://www.twentyonepilots.com/sites/g/files/g2000020241/files/2025-06/desktopHeaderBg_0.jpg'),
        url('https://nitter.net/pic/media%2FGz7rRzDXEAATCsx.jpg%3Fname%3Dsmall%26format%3Dwebp');
      background-blend-mode: normal, overlay, normal;
    }

    .clock-container {
      position: relative;
      background: rgba(0,0,0,0.7);
      backdrop-filter: blur(10px);
      padding: 2rem 2rem 2.5rem;
      border-radius: 1rem;
      text-align: center;
      width: 90%; max-width: 640px;
      box-shadow: 0 4px 30px rgba(0,0,0,0.7);
      overflow: hidden;
    }

    /* Fixed logo row */
    .logo-wrap{
      width: 100%;
      display: grid;
      place-items: center;
      margin-bottom: 0.75rem;
      min-height: clamp(52px, 10vw, 90px);
    }
    .album-logo{
      max-width: clamp(160px, 45%, 300px);
      width: auto;
      height: clamp(42px, 8vw, 80px);
      object-fit: contain;
      object-position: center;
      pointer-events: none;
      user-select: none;
      filter: drop-shadow(0 0 12px rgba(0,0,0,0.9)) drop-shadow(0 0 4px rgba(255,221,0,0.25));
    }

    h1 {
      font-size: clamp(2rem, 4.2vw, 2.8rem);
      color: #FFDD00;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      margin: 0.25rem 0 0.5rem;
      animation: pulse-glow 2s ease-in-out infinite;
    }
    @keyframes pulse-glow {
      0%,100%{text-shadow:0 0 10px rgba(255,221,0,0.8),0 0 20px rgba(255,221,0,0.6);}
      50%{text-shadow:0 0 20px rgba(255,221,0,1),0 0 30px rgba(255,221,0,0.8);}
    }

    .date-display {
      font-size: 1rem;
      margin-bottom: 0.5rem;
      opacity: 0.9;
      display: flex;
      justify-content: center;
      gap: 1rem;
      align-items: center;
      flex-wrap: wrap;
    }

    .timer { font-size: clamp(1.8rem, 5vw, 2.4rem); margin: 1rem 0; }
    .label { font-size: 1rem; opacity: 0.9; margin-bottom: 1rem; }

    .buttons { display: flex; gap: 0.75rem; justify-content: center; margin-top: 1rem; flex-wrap: wrap; }
    .btn, select.btn {
      display: inline-flex; align-items: center; gap: 0.5rem;
      padding: 0.7rem 1.4rem; font-size: 1rem;
      border: 2px solid; border-radius: 999px;
      text-decoration: none; transition: transform .2s ease, box-shadow .2s ease;
      cursor: pointer; background: rgba(0,0,0,0.4); color: inherit;
    }
    .btn:hover, select.btn:hover { transform: scale(1.05); box-shadow: 0 0 10px rgba(255,221,0,0.7); }
    select { font-family: 'Martian Mono', monospace; }

    .progress-container { width: 100%; background: rgba(255,255,255,0.2); border-radius: 5px; overflow: hidden; margin: 1rem 0; }
    .progress-bar { height: 10px; width: 0; background: #FFDD00; transition: width .5s ease; }

    canvas { position: absolute; inset: 0; width: 100%; height: 100%; pointer-events: none; }
    .privacy { margin-top: 1.5rem; font-size: .9rem; opacity: .8; }
    .privacy a { text-decoration: underline; }

    #langSelect { background: rgba(0,0,0,0.4); color: inherit; border: 2px solid; border-radius: 999px; padding: 0.7rem 1.4rem; }
    #langSelect:hover { transform: scale(1.05); box-shadow: 0 0 10px rgba(255,221,0,0.7); }

    @media (max-width: 380px){
      .logo-wrap{ min-height: 48px; }
      .album-logo{ height: 48px; max-width: 72%; }
    }
  </style>
</head>
<body>
  <div class="clock-container" id="container">
    <div class="logo-wrap" aria-hidden="true">
      <img
        class="album-logo"
        alt=""
        src="https://www.twentyonepilots.com/sites/g/files/g2000020241/files/2025-06/Top_Album_LogoNew.svg"
      />
    </div>

    <canvas id="confetti"></canvas>
    <h1 id="title">Breach Clock</h1>

    <div class="date-display">
      <span id="dateDisplay">Loading date…</span>
      <span id="daysLeft">-- days left</span>
    </div>

    <div class="progress-container">
      <div class="progress-bar" id="progressBar"></div>
    </div>

    <div class="timer" id="timeValue">00:00:00</div>
    <div class="label" id="timeLabel">Time until Breach (local 00:00)</div>

    <div class="buttons">
      <button class="btn" id="toggleTheme"><i class="fas fa-adjust"></i> Switch Theme</button>
      <button class="btn" id="toggleMode"><i class="fas fa-sync-alt"></i> Toggle Mode</button>
      <select id="langSelect" class="btn"></select>
    </div>

    <div class="privacy"><a href="/optout" id="privacyLink">Privacy / Opt-out</a></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
  <script>
    const langs = [
      {code:'en',name:'English', strings:{ until:'Time until Breach (local 00:00)', since:'Time since Breach (local 00:00)', switch:'Switch Theme', toggle:'Toggle Mode', privacy:'Privacy / Opt-out', days:'days left', self:'💥 Breach is live! 💥', update:'Breach Clock update!'}},
      {code:'es',name:'Español', strings:{ until:'Tiempo hasta Breach (00:00 local)', since:'Tiempo desde Breach (00:00 local)', switch:'Cambiar Tema', toggle:'Cambiar Modo', privacy:'Privacidad / Opt-out', days:'días restantes', self:'💥 ¡Breach ya está aquí! 💥', update:'¡Actualización Breach Clock!'}},
      {code:'fr',name:'Français', strings:{ until:'Temps avant Breach (00:00 local)', since:'Temps depuis Breach (00:00 local)', switch:'Changer Thème', toggle:'Changer Mode', privacy:'Confidentialité / Opt-out', days:'jours restants', self:'💥 Breach est sorti ! 💥', update:'Mise à jour Breach Clock !'}},
      {code:'de',name:'Deutsch', strings:{ until:'Zeit bis Breach (00:00 lokal)', since:'Zeit seit Breach (00:00 lokal)', switch:'Thema wechseln', toggle:'Modus wechseln', privacy:'Datenschutz / Opt-out', days:'Tage übrig', self:'💥 Breach ist da! 💥', update:'Breach Clock Update!'}},
      {code:'it',name:'Italiano', strings:{ until:'Tempo a Breach (00:00 locale)', since:'Tempo da Breach (00:00 locale)', switch:'Cambia Tema', toggle:'Cambia Modalità', privacy:'Privacy / Opt-out', days:'giorni rimanenti', self:'💥 Breach è uscito! 💥', update:'Aggiornamento Breach Clock!'}},
      {code:'pt',name:'Português', strings:{ until:'Tempo até Breach (00:00 local)', since:'Tempo desde Breach (00:00 local)', switch:'Mudar Tema', toggle:'Mudar Modo', privacy:'Privacidade / Opt-out', days:'dias restantes', self:'💥 Breach no ar! 💥', update:'Atualização Breach Clock!'}},
      {code:'ru',name:'Русский', strings:{ until:'Время до Breach (00:00 местн.)', since:'Время после Breach (00:00 местн.)', switch:'Сменить Тему', toggle:'Сменить Режим', privacy:'Конфиденциальность / Opt-out', days:'дней осталось', self:'💥 Breach вышел! 💥', update:'Обновление Breach Clock!'}},
      {code:'zh',name:'中文', strings:{ until:'距离 Breach（本地 00:00）', since:'自 Breach（本地 00:00）起', switch:'切换主题', toggle:'切换模式', privacy:'隐私 / 退订', days:'天 剩余', self:'💥 Breach 已上线！💥', update:'Breach 时钟更新！'}},
      {code:'ja',name:'日本語', strings:{ until:'Breach まで（ローカル 00:00）', since:'Breach から（ローカル 00:00）', switch:'テーマ切替', toggle:'モード切替', privacy:'プライバシー / Opt-out', days:'日 残り', self:'💥 Breach 配信！ 💥', update:'Breach Clock アップデート！'}},
      {code:'ko',name:'한국어', strings:{ until:'Breach 까지 (현지 00:00)', since:'Breach 이후 (현지 00:00)', switch:'테마 전환', toggle:'모드 전환', privacy:'개인정보 / 옵트아웃', days:'일 남음', self:'💥 Breach 공개! 💥', update:'Breach 시계 업데이트!'}},
      {code:'ar',name:'العربية', strings:{ until:'الوقت حتى Breach (00:00 المحلي)', since:'الوقت منذ Breach (00:00 المحلي)', switch:'تغيير الثيم', toggle:'تبديل الوضع', privacy:'الخصوصية / الانسحاب', days:'أيام متبقية', self:'💥 تم إصدار Breach! 💥', update:'تحديث Breach Clock!'}},
      {code:'tr',name:'Türkçe', strings:{ until:"Breach'e Kalan Süre (00:00 yerel)", since:"Breach'ten Beri Geçen Süre (00:00 yerel)", switch:'Tema Değiştir', toggle:'Mod Değiştir', privacy:'Gizlilik / Opt-out', days:'gün kaldı', self:'💥 Breach çıktı! 💥', update:'Breach Clock güncellemesi!'}},
      {code:'nl',name:'Nederlands', strings:{ until:'Tijd tot Breach (00:00 lokaal)', since:'Tijd sinds Breach (00:00 lokaal)', switch:'Thema wisselen', toggle:'Modus wisselen', privacy:'Privacy / Opt-out', days:'dagen over', self:'💥 Breach is live! 💥', update:'Breach Clock update!'}},
      {code:'pl',name:'Polski', strings:{ until:'Czas do Breach (00:00 lokalnie)', since:'Czas od Breach (00:00 lokalnie)', switch:'Zmień Motyw', toggle:'Przełącz Tryb', privacy:'Prywatność / Opt-out', days:'dni pozostało', self:'💥 Breach już jest! 💥', update:'Aktualizacja Breach Clock!'}},
      {code:'hi',name:'हिन्दी', strings:{ until:'Breach तक का समय (स्थानीय 00:00)', since:'Breach के बाद समय (स्थानीय 00:00)', switch:'थीम बदलें', toggle:'मोड बदलें', privacy:'गोपनीयता / Opt-out', days:'दिन शेष', self:'💥 Breach आ गया! 💥', update:'Breach Clock अपडेट!'}},
      {code:'sv',name:'Svenska', strings:{ until:'Tid till Breach (00:00 lokal)', since:'Tid sedan Breach (00:00 lokal)', switch:'Byt Tema', toggle:'Byt Läge', privacy:'Sekretess / Opt-out', days:'dagar kvar', self:'💥 Breach är här! 💥', update:'Breach Clock uppdatering!'}}
    ];

    const TARGET = new Date(2025, 8, 12, 0, 0, 0); // local midnight Sept 12, 2025

    let langIndex = 0;
    let modeUntil = true;

    function populateLangSelect() {
      const sel = document.getElementById('langSelect');
      langs.forEach((l, i) => {
        const opt = document.createElement('option');
        opt.value = i;
        opt.textContent = l.name;
        sel.appendChild(opt);
      });
      sel.value = langIndex;
      sel.addEventListener('change', () => {
        langIndex = parseInt(sel.value);
        applyLang(); updateDate(); updateClocks();
      });
    }

    function applyLang(){
      const s = langs[langIndex].strings;
      document.getElementById('privacyLink').textContent = s.privacy;
      document.getElementById('toggleTheme').innerHTML = `<i class="fas fa-adjust"></i> ${s.switch}`;
      document.getElementById('toggleMode').innerHTML = `<i class="fas fa-sync-alt"></i> ${s.toggle}`;
      document.getElementById('timeLabel').textContent = modeUntil ? s.until : s.since;
    }

    function pad(n){ return n.toString().padStart(2,'0'); }

    function updateDate(){
      const now = new Date();
      const opt = { weekday:'long', year:'numeric', month:'long', day:'numeric' };
      document.getElementById('dateDisplay').textContent = now.toLocaleDateString(langs[langIndex].code, opt);

      const msPerDay = 24*60*60*1000;
      const diffDays = Math.ceil((TARGET - now) / msPerDay);
      const daysText = diffDays >= 0 ? `${diffDays} ${langs[langIndex].strings.days}` : `0 ${langs[langIndex].strings.days}`;
      document.getElementById('daysLeft').textContent = daysText;
    }

    function updateClocks(){
      const now = new Date();

      // Auto-switch to "since" after TARGET
      if (modeUntil && now >= TARGET) {
        modeUntil = false;
        applyLang();
        confetti({ particleCount: 240, spread: 200, startVelocity: 50, origin: { y: 0.5 } });
      }

      const untilMs = Math.max(0, TARGET - now);
      const sinceMs = Math.max(0, now - TARGET);
      const fmt = ms => {
        const ts = Math.floor(ms/1000);
        const d = Math.floor(ts / 86400);
        const h = Math.floor((ts % 86400) / 3600);
        const m = Math.floor((ts % 3600) / 60);
        const s = ts % 60;
        return (d > 0 ? `${d}d ` : '') + `${pad(h)}:${pad(m)}:${pad(s)}`;
      };
      const val = modeUntil ? fmt(untilMs) : fmt(sinceMs);
      document.getElementById('timeValue').textContent = val;

      // Daily progress
      const startOfDay = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 0, 0, 0);
      const endOfDay = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 23, 59, 59, 999);
      const daySpan = endOfDay - startOfDay;
      const dayElapsed = now - startOfDay;
      const pct = Math.min(100, Math.max(0, Math.floor(dayElapsed / daySpan * 100)));
      document.getElementById('progressBar').style.width = `${pct}%`;
    }

    document.getElementById('toggleTheme').addEventListener('click', () => {
      document.body.classList.toggle('red');
    });

    document.getElementById('toggleMode').addEventListener('click', () => {
      modeUntil = !modeUntil;
      applyLang();
    });

    (function init(){
      document.getElementById('title').textContent = 'Breach Clock';
      populateLangSelect();
      applyLang();
      updateDate();
      updateClocks();
      setInterval(() => { updateDate(); updateClocks(); }, 500);
    })();
  </script>
</body>
</html>
